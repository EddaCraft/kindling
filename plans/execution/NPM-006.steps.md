# Steps: NPM-006

| Field | Value |
|-------|-------|
| Source | [../modules/npm-publishing.aps.md](../modules/npm-publishing.aps.md) |
| Task(s) | NPM-006 â€” Verify CLI executable |
| Created by | @aneki / AI |
| Status | Draft |

## Why This Matters

The CLI must work correctly after npm installation. A broken CLI creates a poor first impression and generates support issues.

## What We're Building

Verification that:
- CLI has proper hashbang
- CLI is executable
- --help and --version work

## Prerequisites

- [ ] CLI package exists
- [ ] Build succeeds

## Steps

### 1. Check source file hashbang

- **Why:** Node needs hashbang for direct execution
- **What:** Verify hashbang in source
- **Checkpoint:** `packages/kindling-cli/src/cli.ts` starts with:
  ```typescript
  #!/usr/bin/env node
  ```
- **Validate:** `head -1 packages/kindling-cli/src/cli.ts`

### 2. Check built file hashbang

- **Why:** Build must preserve hashbang
- **What:** Verify hashbang in dist
- **Checkpoint:** `packages/kindling-cli/dist/cli.js` starts with:
  ```javascript
  #!/usr/bin/env node
  ```
- **Validate:** `head -1 packages/kindling-cli/dist/cli.js`

### 3. Check bin field in package.json

- **Why:** npm uses bin field for CLI
- **What:** Verify bin configuration
- **Checkpoint:** `packages/kindling-cli/package.json` has:
  ```json
  "bin": {
    "kindling": "./dist/cli.js"
  }
  ```
- **Validate:** `node -e "console.log(require('./packages/kindling-cli/package.json').bin)"`

### 4. Test --help output

- **Why:** Basic functionality check
- **What:** Run CLI with --help
- **Checkpoint:** CLI responds to --help:
  ```bash
  node packages/kindling-cli/dist/cli.js --help
  ```
  - Exits with code 0
  - Shows usage information
- **Validate:** Exit code is 0

### 5. Test --version output

- **Why:** Version reporting
- **What:** Run CLI with --version
- **Checkpoint:** CLI responds to --version:
  ```bash
  node packages/kindling-cli/dist/cli.js --version
  ```
  - Exits with code 0
  - Shows version number
- **Validate:** Exit code is 0, version shown

### 6. Test npm pack includes bin

- **Why:** Ensure bin ships in package
- **What:** Verify pack contents
- **Checkpoint:** Pack includes CLI:
  ```bash
  cd packages/kindling-cli && pnpm pack --dry-run
  ```
  - dist/cli.js is listed
- **Validate:** cli.js appears in pack output

## Completion

- [ ] All checkpoints validated
- [ ] Task marked complete in source module

**Completed by:** ___
